# 算法分析与设计 hw6


## 1 理论题

> 使用归纳法证明背包问题的贪心最优解

部分背包问题：给定 $n$ 种物品和一个背包。物品 $i$ 的重量是 $w_i$，其价值为 $v_i$，背包的容量为 $W$。问如何选择装入背包的物品，使得装入背包的物品的价值最大。每种物品可以部分地装入。

形式描述：给定 $w_i>0,v_i>0,1\le i\le n$，以及 $W>0$，求一个 $n$ 元向量 $(x_1,x_2,...,x_n )$ ，使得它是下述最优化问题的解。
$$
\begin{aligned}
\max\quad &\sum_{i=1}^{n}x_iv_i\\
\mbox{s.t.}\quad &\sum_{i=1}^{n}x_iw_i \le W\\
&0 \le x_i \le 1,1\le i\le n
\end{aligned}
$$

**证明**：

**1 证明：部分背包问题具有最优子结构性质**

对于部分背包问题，设 $A$ 是装入容量为 $W$ 的背包的具有最大价值的物品集合，若 $A$ 包含物品 $j$，则从 $A$ 中拿出所含物品 $j$ **已装入那部分**重量 $w$，所剩的物品集记为 $A_j$，则 $A_j$ 是其它 $n-1$ 个原重物品 $1,2,...,j-1,j+1,..., n$ 以及重为 $w_j- w$ 的物品 $j$ 中可装入容量为 $W- w$ 的背包中价值最大的物品集合。



**2 证明：部分背包问题具有贪心选择性质**

我们需要证明我们可以从局部最优解构造出全局最优解。这就是要证明，如果我们每次挑选出单位价值最大的物品，我们最终会得到所有物品在背包容量限制 $W$ 下的最优价值。

考虑一个非空集 $S$，设 $m$ 为 $S$ 中单位重量价值 $(v_m/w_m)$ 最大的物品。设 $A$ 为 $S$ 的子集，使 $A$ 在限制 $W$ 下有最大值，$j$ 是 $A$ 中单位重量价值 $(v_j/w_j)$ 最大的物品。为了证明部分背包问题具有贪心选择性质，我们需要证明，$m$ 必须在 $A$ 子集中。

通过选择 $m$，我们将遇到两种情况：

**情况 1**：$w_m \ge W$

在这种情况下，背包是满的。因为 $m$ 是单位重量价值 $(v_m/w_m)$ 最大的物品，所以对于 $W \times (v_i/w_i), 1\le i\le n$，$W \times (v_m/w_m)$ 必定是最大的价值。问题已得证。

**情况 2**：$w_m<W$

在这种情况下，我们可以肯定地知道，对于重量 $w_m$，$v_m$ 是这种物品能够带来的最大价值。

* 若 $m=j$，问题已得证。
* 若 $m \ne j$，要想取得价值 $v_m$，物品 $j$ 的重量必须比 $w_m$ 大。这是因为，对于重量 $w_m$，$v_m$ 是它的最大价值。也就是说，如果我们用 $A$ 中的物品 $j$ 替换物品 $m$，背包的价值会降低。这与原来的最优解相矛盾。故问题得证。



**3 证明：部分背包问题通过每一步的贪心选择可以得到最优解**

设原问题的物品集合为 $S$，设 $A$ 是装入容量为 $W$ 的背包的具有最大价值的物品集合。

* $|A|=1$ 时，放入的第一个物品是单位重量价值最大的，由贪心选择性质可知，问题成立。
* 假设当 $|A|=k$ 时问题成立。即放入的第 $k$ 个物品是剩下物品中单位重量价值最大的。
* 当 $|A|=k+1$ 时：
  * 由贪心选择性质，剩下物品中第一个放入单位重量价值最大的物品可以得到 $S - \{1,2,...,k\}$ 的最优解。
  * 由最优子结构性质，$A - \{1,2,...,k\}$ 是 $S - \{1,2,...,k\}$ 的最优解。因此放入第 $k+1$ 个物品时，选择剩下物品中单位重量价值最大的，可以得到最优解。

